<!doctype html>
<html lang="es">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentos desde MongoDB</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #333;
            color: white;
        }
    </style>
</head>
<body>

    <h1>Lista de Documentos</h1>
    <div id="message"></div>
    <table id="documentos-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Fecha</th>
            </tr>
        </thead>
        <tbody id="documentos-body">
            <!-- Aquí se insertarán los datos de los documentos -->
        </tbody>
    </table>

    <script>
        async function fetchDocumentos() {
            try {
                const response = await fetch('http://www.refactorii.com/getDocumentosData'); // Cambia el puerto si es necesario
                if (!response.ok) {
                    throw new Error(`Error al obtener datos: ${response.status}`);
                }
                const data = await response.json();

                if (data.documentos && data.documentos.length > 0) {
                    populateTable(data.documentos);
                } else {
                    document.getElementById('message').innerText = 'No se encontraron documentos.';
                }
            } catch (error) {
                console.error("Error al obtener documentos:", error);
                document.getElementById('message').innerText = 'Error al obtener documentos. Consulte la consola para más detalles.';
            }
        }

        function populateTable(documentos) {
            const tableBody = document.getElementById('documentos-body');
            tableBody.innerHTML = ''; // Limpia cualquier contenido previo

            documentos.forEach(doc => {
                const row = document.createElement('tr');
                
                // Crear una celda para cada campo
                const idCell = document.createElement('td');
                idCell.innerText = doc._id;
                row.appendChild(idCell);

                const nameCell = document.createElement('td');
                nameCell.innerText = doc.nombre || 'N/A'; // Reemplaza con el nombre del campo en tu modelo
                row.appendChild(nameCell);

                const descCell = document.createElement('td');
                descCell.innerText = doc.descripcion || 'N/A'; // Reemplaza con el nombre del campo en tu modelo
                row.appendChild(descCell);

                const dateCell = document.createElement('td');
                dateCell.innerText = new Date(doc.fecha).toLocaleDateString() || 'N/A'; // Reemplaza con el campo de fecha en tu modelo
                row.appendChild(dateCell);

                tableBody.appendChild(row);
            });
        }

        // Llamar a la función para cargar los datos al cargar la página
        window.onload = fetchDocumentos;
    </script>
</body>
</html>
