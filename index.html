<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proyecto Vue con Vuex</title>
  <!-- Vuetify CDN -->
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.5.10/dist/vuetify.min.css" rel="stylesheet">
  <!-- Vue CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
  <!-- Vuex CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vuex@3.6.2/dist/vuex.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
<div id="app">
  <v-app>
    <v-container>
      <v-toolbar flat>
        <v-toolbar-title>Auditoría de Documentos</v-toolbar-title>
        <v-spacer></v-spacer>
        <v-btn color="primary" @click="abrirModalCrearDocumento" dark>Crear Documento</v-btn>
      </v-toolbar>

      <!-- Tabla de Documentos -->
      <v-data-table
        :headers="headers"
        :items="documentos"
        item-value="folio"
        class="elevation-1"
      >
        <template v-slot:item.actions="{ item }">
          <!-- Botón para ver detalles del documento -->
          <v-btn text icon color="blue" @click="abrirModalVerDetalles(item)">
            <v-icon>info</v-icon>
          </v-btn>
          <!-- Botón para editar el documento -->
          <v-btn text icon color="green" @click="abrirModalEditarDocumento(item)">
            <v-icon>edit</v-icon>
          </v-btn>
        </template>
      </v-data-table>

      <!-- Modal Crear Documento -->
      <v-dialog v-model="dialogCrearDocumento" max-width="800px">
        <v-card>
          <v-card-title>
            <span class="headline">Crear Documento</span>
          </v-card-title>
          <v-card-text>
            <v-form>
              <v-row>
                <!-- Campos de entrada para los datos del documento -->
                <v-col cols="12" md="3">
                  <v-text-field label="Tipo Documento" v-model="nuevoDocumento.tipoDocumento"></v-text-field>
                </v-col>
                <!-- Añadir más campos según se necesite -->
              </v-row>
            </v-form>
          </v-card-text>
          <v-card-actions>
            <v-spacer></v-spacer>
            <v-btn color="blue darken-1" text @click="dialogCrearDocumento = false">Cancelar</v-btn>
            <v-btn color="blue darken-1" text @click="submitForm">Guardar</v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>

      <!-- Modal Ver Detalles -->
      <v-dialog v-model="dialogVerDetalles" max-width="600px">
        <v-card>
          <v-card-title>
            <span class="headline">Detalles del Documento</span>
          </v-card-title>
          <v-card-text>
            <div v-if="documentoSeleccionado">
              <p><strong>Tipo Documento:</strong> {{ documentoSeleccionado.tipoDocumento }}</p>
              <!-- Muestra más detalles aquí -->
            </div>
          </v-card-text>
          <v-card-actions>
            <v-spacer></v-spacer>
            <v-btn color="blue darken-1" text @click="dialogVerDetalles = false">Cerrar</v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>

    </v-container>
  </v-app>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.5.10/dist/vuetify.js"></script>
<script>
  // Configuración de Vuex Store
  const store = new Vuex.Store({
    state: {
      documentos: [
        // Ejemplo de documento inicial
        {
          tipoDocumento: 'Factura',
          cufeCude: 'CUFE123456789',
          folio: '12345',
          prefijo: 'F',
          fechaEmision: '2024-01-01',
          fechaRecepcion: '2024-01-02',
          nitEmisor: '123456789',
          nombreEmisor: 'Empresa S.A.S.',
          nitReceptor: '987654321',
          nombreReceptor: 'Cliente S.A.S.',
          iva: 19,
          ica: 5,
          ipc: 3,
          total: 100000,
          estado: 'Pendiente',
          grupo: 'Grupo A'
        },
        // Más documentos si es necesario
      ],
      nuevoDocumento: {
        tipoDocumento: '',
        cufeCude: '',
        folio: '',
        prefijo: '',
        fechaEmision: '',
        fechaRecepcion: '',
        nitEmisor: '',
        nombreEmisor: '',
        nitReceptor: '',
        nombreReceptor: '',
        iva: 0,
        ica: 0,
        ipc: 0,
        total: 0,
        estado: '',
        grupo: ''
      },
      documentoSeleccionado: null,
      dialogCrearDocumento: false,
      dialogVerDetalles: false,
    },
    mutations: {
      agregarDocumento(state, documento) {
        state.documentos.push(documento);
      },
      seleccionarDocumento(state, documento) {
        state.documentoSeleccionado = documento;
      },
      limpiarNuevoDocumento(state) {
        Object.keys(state.nuevoDocumento).forEach(key => {
          state.nuevoDocumento[key] = '';
        });
      }
    },
    actions: {
      agregarDocumento({ commit, state }) {
        commit('agregarDocumento', { ...state.nuevoDocumento });
        commit('limpiarNuevoDocumento');
      }
    },
    getters: {
      documentos: state => state.documentos,
      nuevoDocumento: state => state.nuevoDocumento,
      documentoSeleccionado: state => state.documentoSeleccionado,
    }
  });

  // Crear la instancia de Vue
  new Vue({
    el: '#app',
    vuetify: new Vuetify(),
    store,
    computed: {
      documentos() {
        return this.$store.getters.documentos;
      },
      headers() {
        return [
          { text: 'Tipo Documento', value: 'tipoDocumento' },
          { text: 'CUFE/CUDE', value: 'cufeCude' },
          { text: 'Folio', value: 'folio' },
          { text: 'Prefijo', value: 'prefijo' },
          { text: 'Fecha Emisión', value: 'fechaEmision' },
          { text: 'Fecha Recepción', value: 'fechaRecepcion' },
          { text: 'NIT Emisor', value: 'nitEmisor' },
          { text: 'Nombre Emisor', value: 'nombreEmisor' },
          { text: 'NIT Receptor', value: 'nitReceptor' },
          { text: 'Nombre Receptor', value: 'nombreReceptor' },
          { text: 'IVA', value: 'iva' },
          { text: 'ICA', value: 'ica' },
          { text: 'IPC', value: 'ipc' },
          { text: 'Total', value: 'total' },
          { text: 'Estado', value: 'estado' },
          { text: 'Grupo', value: 'grupo' },
          { text: 'Acciones', value: 'actions', sortable: false },
        ];
      },
      nuevoDocumento() {
        return this.$store.getters.nuevoDocumento;
      },
      documentoSeleccionado() {
        return this.$store.getters.documentoSeleccionado;
      },
    },
    methods: {
      abrirModalCrearDocumento() {
        this.$store.commit('limpiarNuevoDocumento');
        this.dialogCrearDocumento = true;
      },
      submitForm() {
        this.$store.dispatch('agregarDocumento');
        this.dialogCrearDocumento = false;
      },
      abrirModalVerDetalles(item) {
        this.$store.commit('seleccionarDocumento', item);
        this.dialogVerDetalles = true;
      },
      abrirModalEditarDocumento(item) {
        // Aquí puedes implementar la lógica para editar el documento
      }
    }
  });
</script>
</body>
</html>
